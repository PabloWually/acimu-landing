---
import ImageModal from "./ImageModal.astro";

interface Props {
    images: { url: string; caption: string }[];
    direction?: "left" | "right";
}

const { images, direction = "left" } = Astro.props;
// Duplicate images to ensure seamless scrolling
const displayImages =
    direction === "left" ? [...images] : [...images.reverse()];
---

<div class="infinite-carousel-container">
    <div class={`infinite-carousel-track ${direction}`}>
        {
            displayImages.map((image, index) => (
                <div
                    class="infinite-carousel-slide"
                    onclick={`window.openImageModal(${index % images.length})`}
                >
                    <img src={image.url} alt={image.caption} />
                </div>
            ))
        }
    </div>
</div>

<ImageModal images={images} />

<style>
    .infinite-carousel-container {
        width: 100%;
        overflow: hidden;
        position: relative;
        margin: 1rem auto;
        border-radius: 8px;
    }

    .infinite-carousel-track {
        display: flex;
        width: max-content;
        animation: scroll 120s linear infinite;
    }

    .infinite-carousel-track.right {
        animation-direction: reverse;
    }

    .infinite-carousel-slide {
        flex: 0 0 auto;
        width: 400px; /* Adjust width as needed */
        height: 300px; /* Adjust height as needed */
        margin-right: 20px;
        cursor: pointer;
    }

    .infinite-carousel-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 4px;
    }

    @keyframes scroll {
        0% {
            transform: translateX(0);
        }
        100% {
            transform: translateX(
                -50%
            ); /* Move by half the total width (original set) */
        }
    }

    @media (max-width: 768px) {
        .infinite-carousel-slide {
            width: 300px;
            height: 225px;
        }
    }
</style>
